//#region react imports

import React from 'react';

//#endregion react imports

//#region application imports

import { ComponentBase, DiscComponent, ControlConstant } from '../../shared';

import { VulnerabilitySummaryPropModel } from './models';
import './vulnerability-summary.scss';

//#endregion application imports

export class VulnerabilitySummaryComponent extends ComponentBase<VulnerabilitySummaryPropModel, any> {

    //#region model properties
    //#endregion model properties

    //#region constructor
    //#endregion constructor

    ///#region life cycle hooks

    componentDidMount() {
        super.componentDidMount();
        this.props.dispatchFetchVulnerabilityBySeverity(this.props.filtersInfo, this.handleApiFetchError.bind(this));
    }

    /**
     * renders html for component 
     */
    render() {
        return (
            <>
                <div className="row space-row">
                    <div className="col-sm-12 col-md-12">
                        <h4 className="field-label">Vulnerabilities by Severity</h4>
                    </div>
                </div>
                <div className="row space-row disc-component mt-2 mt-sm-5 pb-5">
                    {this.renderVulnerabilitiesBySeverity()}
                </div>
            </>
        );
    }

    //#endregion life cycle hooks

    //#region event callbacks/public methods
    //#endregion events callbacks/public methods

    //#region private methods

    /** 
     * render vulnerabilities by severity component
     */
    private renderVulnerabilitiesBySeverity() {
        if (this.props.vulnerabilitiesBySeverity) {
            return (
                <>
                    {this.props.vulnerabilitiesBySeverity.sort((a, b) => ControlConstant.severity.indexOf(a.text) - ControlConstant.severity.indexOf(b.text))
                        .map(function (x) {
                            return (
                                <>
                                    <DiscComponent type={x.text} innerText={x.text} displayText={x.value} />
                                </>
                            )
                        })}
                </>
            )
        }
        return (null);

    }

    //#endregion private methods
}