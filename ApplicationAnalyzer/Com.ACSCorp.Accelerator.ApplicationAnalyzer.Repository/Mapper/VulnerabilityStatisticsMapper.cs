using Com.ACSCorp.Accelerator.ApplicationAnalyzer.Models.DTO;
using Com.ACSCorp.Accelerator.ApplicationAnalyzer.Repository.Models;

using System.Collections.Generic;

namespace Com.ACSCorp.Accelerator.ApplicationAnalyzer.Repository.Mapper
{
    public static class VulnerabilityStatisticsMapper
    {
        public static List<VulnerabilityStatistics> ToVulnerabilityStatisticsList(this List<VulnerabilityStatisticsDTO> vulnerabilityStatisticsDTOs)
        {
            var vulnerabilityStatisticsList = new List<VulnerabilityStatistics>();

            foreach (var entity in vulnerabilityStatisticsDTOs)
            {
                vulnerabilityStatisticsList.Add(entity.ToVulnerabilityStatistics());
            }

            return vulnerabilityStatisticsList;
        }

        public static VulnerabilityStatistics ToVulnerabilityStatistics(this VulnerabilityStatisticsDTO vulnerabilityStatisticsDTO)
        {
            var vulnerabilityStatistics = new VulnerabilityStatistics
            {
                Id = vulnerabilityStatisticsDTO.Id,
                ClientId = vulnerabilityStatisticsDTO.ClientId,
                DivisionId = vulnerabilityStatisticsDTO.DivisionId,
                ProjectId = (byte)vulnerabilityStatisticsDTO.ProjectId,
                ScanDate = vulnerabilityStatisticsDTO.ScanDate,
                ScanId = vulnerabilityStatisticsDTO.ScanId,
                ScanTypeId = vulnerabilityStatisticsDTO.ScanTypeId,
                Severity = vulnerabilityStatisticsDTO.Severity,
                Type = vulnerabilityStatisticsDTO.Type ?? string.Empty,
                Value = vulnerabilityStatisticsDTO.Value
            };

            return vulnerabilityStatistics;
        }
    }
}
